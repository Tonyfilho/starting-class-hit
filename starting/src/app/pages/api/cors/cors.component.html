<div class="header">
  <h1>CORS - Cross-Origin Resource Sharing</h1>
  <p class="subtitle">
    Entenda o que √© CORS, por que acontece e como resolver.
  </p>
</div>
<div class="card right-align">
  <button class="home-button" routerLink="/">Go Back to Home</button>
</div>

<section class="container-guide">
  <div class="content-wrap">

    <article>
      <section class="topic">
        <h2>üåê O que √© CORS?</h2>
        <p>
          O <strong>CORS (Cross-Origin Resource Sharing)</strong> √© uma pol√≠tica de seguran√ßa implementada pelos
          navegadores. Ele impede que p√°ginas web fa√ßam requisi√ß√µes a um dom√≠nio diferente daquele de onde a p√°gina foi
          carregada, a menos que o servidor permita explicitamente esse acesso.
        </p>
        <p>
          Isso protege contra ataques como <em>Cross-Site Scripting (XSS)</em> e <em>Cross-Site Request Forgery
            (CSRF)</em>.
        </p>
      </section>

      <section class="topic">
        <h3>üîí Quando o erro CORS ocorre?</h3>
        <p>
          Por padr√£o, se uma aplica√ß√£o Angular estiver rodando em <code>http://localhost:4200</code> e tentar acessar
          uma API hospedada em outro dom√≠nio (ex: <code>https://api.exemplo.com</code>), o navegador bloquear√° a
          resposta se o servidor da API n√£o estiver configurado para permitir essa origem.
        </p>
        <h4>‚ùå Exemplo de erro no console:</h4>
        <pre><code>
Access to fetch at 'https://api.exemplo.com/dados'
from origin 'http://localhost:4200' has been blocked by CORS policy:
No 'Access-Control-Allow-Origin' header is present on the requested resource.
        </code></pre>
      </section>

      <section class="topic">
        <h3>1. Utilizando proxy para desenvolvimento local</h3>
        <p>
          Voc√™ pode usar um arquivo de proxy no Angular para redirecionar chamadas durante o desenvolvimento e evitar
          CORS sem alterar o backend:
        </p>

        <pre><code>// proxy.conf.json
{{"{"}}
  "/api": {{"{"}}
    "target": "https://api.exemplo.com",
    "secure": false,
    "changeOrigin": true,
    "logLevel": "debug"
  {{"}"}}
{{"}"}}
</code></pre>

        <p>Depois, altere o comando de execu√ß√£o no <code>angular.json</code> ou use:</p>

        <pre><code>ng serve --proxy-config proxy.conf.json</code></pre>
      </section>

      <section class="topic">
        <h3>‚úÖ Como resolver o erro CORS</h3>
        <p>O servidor da API precisa incluir o cabe√ßalho <code>Access-Control-Allow-Origin</code> nas respostas. Abaixo
          alguns exemplos de como configurar isso em diferentes tecnologias:</p>

        <div class="card">
          <h4>üîß Node.js (Express)</h4>
          <pre><code>
const express = require('express');
const cors = require('cors');
const app = express();

app.use(cors()); // Permite todas as origens

app.get('/dados', (req, res) => {{"{"}}
  res.json({{"{"}} mensagem: 'CORS liberado!' {{"}"}});
{{"}"}});

app.listen(3000);
          </code></pre>
        </div>

        <div class="card">
          <h4>‚òï Java (Spring Boot)</h4>
          <pre><code>
{{"@RestController"}}
public class ApiController {{"{"}}

  {{'@CrossOrigin(origins = "http://localhost:4200")'}}
  {{'@GetMapping("/dados")'}}
  public ResponseEntity&lt;String&gt; getDados() {{"{"}}
    return ResponseEntity.ok("CORS liberado!");
  {{"}"}}
{{"}"}}
          </code></pre>
        </div>

        <div class="card">
          <h4>üî• Firebase Functions</h4>
          <pre><code>
const functions = require('firebase-functions');
const cors = require('cors')({{"{"}} origin: true {{"}"}});

exports.dados = functions.https.onRequest((req, res) => {{"{"}}
  cors(req, res, () => {{"{"}}
    res.json({{"{"}} mensagem: 'CORS liberado no Firebase!' {{"}"}});
  {{"}"}});
{{"}"}});
          </code></pre>
        </div>
      </section>

      <section class="topic">
        <h3>üìå Dicas finais</h3>
        <ul>
          <li>Use bibliotecas como <code>cors</code> no Node.js para facilitar a configura√ß√£o.</li>
          <li>Evite permitir <code>*</code> em produ√ß√£o. Prefira definir as origens espec√≠ficas.</li>
          <li>Em desenvolvimento, use <code>proxy.conf.json</code> no Angular para contornar CORS sem mexer na API.</li>
        </ul>
        <pre><code>
// angular.json
"architect": {{"{"}}
  "serve": {{"{"}}
    "options": {{"{"}}
      "proxyConfig": "src/proxy.conf.json"
    {{"}"}}
  {{"}"}}
{{"}"}}
        </code></pre>
      </section>
    </article>

  </div>
</section>
